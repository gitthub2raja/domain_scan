"use strict";(()=>{var e={};e.id=817,e.ids=[817],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},665:e=>{e.exports=require("dns")},1764:e=>{e.exports=require("util")},1419:(e,s,o)=>{o.r(s),o.d(s,{originalPathname:()=>x,patchFetch:()=>S,requestAsyncStorage:()=>y,routeModule:()=>b,serverHooks:()=>f,staticGenerationAsyncStorage:()=>w});var t={};o.r(t),o.d(t,{POST:()=>v});var a=o(9303),i=o(8716),n=o(670),r=o(7070),d=o(665),m=o.n(d),p=o(1764);let u=(0,p.promisify)(m().resolve4),c=(0,p.promisify)(m().resolve6),l=(0,p.promisify)(m().resolveMx),h=(0,p.promisify)(m().resolveTxt);(0,p.promisify)(m().resolveNs);let g=["www","mail","ftp","admin","api","blog","cdn","dev","staging","test","secure","vpn","portal","docs","support","webmail","imap","smtp","pop","ns1","ns2","mx","www2","shop","store","app","mobile","m","old","new","beta","alpha","demo","staging2","test2","backup","db","mysql","postgres","redis","cache","static","assets","media","images","img","video","videos","download","downloads","files","file","upload","uploads","share","shared","public","private","web","web2","www3","mail2","smtp2","imap2","pop3","exchange","owa","autodiscover","lync","skype","teams","connect","openvpn","vpn1","vpn2","remote","rdp","ssh","telnet"];async function v(e){try{let{domain:s}=await e.json();if(!s||"string"!=typeof s)return r.NextResponse.json({error:"Domain is required"},{status:400});if(!/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s))return r.NextResponse.json({error:"Invalid domain format"},{status:400});let o={domain:s,mxRecords:[],txtRecords:[],subdomains:[],vulnerabilities:[]};try{let e=await l(s);o.mxRecords=e.map(e=>({exchange:e.exchange,priority:e.priority}))}catch(e){}try{let e=await h(s);o.txtRecords=e.map(e=>Array.isArray(e)?e.join(" "):e)}catch(e){}let t=new Map;for(let e=0;e<g.length;e+=50){let o=g.slice(e,e+50).map(async e=>{let o=`${e}.${s}`;if(!t.has(o))try{let e=u(o),s=new Promise((e,s)=>setTimeout(()=>s(Error("Timeout")),2e3)),a=await Promise.race([e,s]);if(a&&a.length>0){let e={subdomain:o,ipv4:a};try{let s=c(o),t=new Promise((e,s)=>setTimeout(()=>s(Error("Timeout")),2e3)),a=await Promise.race([s,t]);a&&a.length>0&&(e.ipv6=a)}catch(e){}t.set(o,e)}}catch(e){}});await Promise.allSettled(o)}o.subdomains=Array.from(t.values()).sort((e,s)=>e.subdomain.localeCompare(s.subdomain));let a=[];o.txtRecords.some(e=>e.includes("v=spf1"))||a.push({type:"Missing SPF Record",severity:"high",description:"No SPF (Sender Policy Framework) record found. This allows email spoofing.",recommendation:"Add an SPF record to your DNS: v=spf1 include:_spf.google.com ~all"}),o.txtRecords.some(e=>e.toLowerCase().includes("v=dmarc1"))||a.push({type:"Missing DMARC Record",severity:"high",description:"No DMARC record found. This reduces email security.",recommendation:"Add a DMARC record: v=DMARC1; p=none; rua=mailto:admin@"+s});let i=["ftp","telnet","rdp","vnc"];o.subdomains.forEach(e=>{let s=e.subdomain.toLowerCase();i.forEach(o=>{s.includes(o)&&a.push({type:`Exposed ${o.toUpperCase()} Service`,severity:"medium",description:`Subdomain ${e.subdomain} appears to expose ${o.toUpperCase()} service.`,recommendation:"Ensure proper authentication and consider using VPN instead of direct exposure."})})});let n=o.subdomains.filter(e=>e.subdomain.toLowerCase().includes("dev")||e.subdomain.toLowerCase().includes("staging")||e.subdomain.toLowerCase().includes("test"));n.length>0&&a.push({type:"Development/Staging Subdomains Exposed",severity:"medium",description:`Found ${n.length} development/staging subdomains that may contain sensitive data.`,recommendation:"Restrict access to development subdomains or use VPN/internal network only."});let d=o.subdomains.filter(e=>e.subdomain.toLowerCase().includes("admin")||e.subdomain.toLowerCase().includes("manage")||e.subdomain.toLowerCase().includes("control"));d.length>0&&a.push({type:"Admin/Management Subdomains Found",severity:"low",description:`Found ${d.length} admin/management subdomains.`,recommendation:"Ensure these subdomains have strong authentication and are not publicly accessible."});let m=new Map;return o.subdomains.forEach(e=>{e.ipv4.forEach(s=>{m.has(s)||m.set(s,[]),m.get(s).push(e.subdomain)})}),m.forEach((e,s)=>{e.length>5&&a.push({type:"Multiple Subdomains on Same IP",severity:"low",description:`${e.length} subdomains share the same IP address (${s}).`,recommendation:"Consider load balancing or separate hosting for critical subdomains."})}),o.subdomains.length>0&&a.push({type:"HTTPS Verification Recommended",severity:"medium",description:"Verify all subdomains use HTTPS and have valid SSL certificates.",recommendation:"Run SSL/TLS scanning on all discovered subdomains."}),o.vulnerabilities=a,r.NextResponse.json({...o,timestamp:new Date().toISOString()})}catch(e){return console.error("Domain scan error:",e),r.NextResponse.json({error:e.message||"Domain scan failed"},{status:500})}}let b=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/domain-scan/route",pathname:"/api/domain-scan",filename:"route",bundlePath:"app/api/domain-scan/route"},resolvedPagePath:"/home/raja/Desktop/domain_scan/app/api/domain-scan/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:y,staticGenerationAsyncStorage:w,serverHooks:f}=b,x="/api/domain-scan/route";function S(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:w})}}};var s=require("../../../webpack-runtime.js");s.C(e);var o=e=>s(s.s=e),t=s.X(0,[276,972],()=>o(1419));module.exports=t})();